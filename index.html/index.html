<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Clima & Press√£o Atmosf√©rica</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:linear-gradient(135deg,#1565c0,#26c6da);
  color:#fff;
  padding:16px;
}
h2{text-align:center}

.card{
  background:rgba(255,255,255,.18);
  border-radius:16px;
  padding:16px;
  margin-bottom:16px;
}

input,button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border:none;
  border-radius:10px;
  font-size:16px;
}

button{
  background:#00e676;
  font-weight:bold;
  cursor:pointer;
}

.autocomplete{
  background:#fff;
  color:#000;
  border-radius:10px;
  margin-top:4px;
  overflow:hidden;
}
.autocomplete div{
  padding:10px;
  cursor:pointer;
}
.autocomplete div:hover{background:#e0e0e0;}

.alerta{
  margin-top:10px;
  padding:10px;
  border-radius:10px;
  font-weight:bold;
}
.alerta.verde{background:#2e7d32;}
.alerta.amarelo{background:#f9a825;color:#000;}
.alerta.vermelho{background:#c62828;}

canvas{
  background:#fff;
  border-radius:10px;
  padding:8px;
}

/* ===== ADICIONADO ‚Äì FUNDO ANIMADO ===== */
#weather-bg{
  position:fixed;
  inset:0;
  z-index:-1;
  overflow:hidden;
  pointer-events:none;
}

/* SOL */
.sun{
  position:absolute;
  top:40px;
  right:40px;
  width:120px;
  height:120px;
  background:radial-gradient(circle,#fff59d,#fbc02d);
  border-radius:50%;
  animation:spin 20s linear infinite;
  opacity:.9;
}

/* NUVENS */
.cloud{
  position:absolute;
  top:80px;
  left:-300px;
  width:200px;
  height:60px;
  background:#fff;
  border-radius:50px;
  opacity:.7;
  animation:cloudMove 80s linear infinite;
}
.cloud::before,.cloud::after{
  content:"";
  position:absolute;
  background:#fff;
  width:80px;
  height:80px;
  border-radius:50%;
  top:-40px;
}
.cloud::before{left:30px}
.cloud::after{left:90px}

/* RAIOS */
.lightning{
  position:absolute;
  top:0;
  left:50%;
  width:4px;
  height:100vh;
  background:#fff;
  opacity:0;
  animation:flash 4s infinite;
}

@keyframes spin{
  from{transform:rotate(0deg)}
  to{transform:rotate(360deg)}
}
@keyframes cloudMove{
  from{left:-300px}
  to{left:110%}
}
@keyframes flash{
  0%,95%,100%{opacity:0}
  96%,98%{opacity:1}
}
/* ===== FIM DO ADICIONADO ===== */

</style>
</head>

<body>

<!-- ===== ADICIONADO ‚Äì CAMADA DO FUNDO ===== -->
<div id="weather-bg"></div>
<!-- ===== FIM ===== -->

<h2 id="titulo">üå¶Ô∏è Clima & Press√£o Atmosf√©rica</h2>

<div class="card">
  <input id="cidade" placeholder="Digite a cidade (ex: Chapec√≥)">
  <div id="lista" class="autocomplete"></div>

  <button onclick="buscar()">Consultar √∫ltimos 7 dias</button>

  <div id="info"></div>
  <div id="historico"></div>
  <div id="previsao"></div>
  <div id="padrao"></div>
  <div id="probChuva"></div>
  <div id="alerta" class="alerta"></div>
</div>

<div class="card">
  <h3>üìä Press√£o atmosf√©rica ‚Äì √∫ltimos 7 dias</h3>
  <canvas id="grafico"></canvas>
</div>

<script>
/* ===== ADICIONADO ‚Äì CONTROLE DO FUNDO ===== */
function atualizarFundoAnimado(tipo){
  const bg=document.getElementById("weather-bg");
  bg.innerHTML="";

  if(tipo==="sol"){
    bg.innerHTML='<div class="sun"></div>';
  }
  if(tipo==="nuvem"){
    bg.innerHTML='<div class="cloud"></div><div class="cloud" style="top:160px;animation-duration:110s"></div>';
  }
  if(tipo==="tempestade"){
    bg.innerHTML='<div class="cloud"></div><div class="cloud" style="top:180px"></div><div class="lightning"></div>';
  }
}
/* ===== FIM ===== */
</script>

<!-- ===== ADICIONADO ‚Äì ATIVA√á√ÉO AUTOM√ÅTICA ===== -->
<script>
/* Observa os alertas j√° existentes e muda o fundo sem alterar l√≥gica */
const alertaObserver=new MutationObserver(()=>{
  const alerta=document.getElementById("alerta");
  if(alerta.classList.contains("vermelho")){
    atualizarFundoAnimado("tempestade");
  }else if(alerta.classList.contains("amarelo")){
    atualizarFundoAnimado("nuvem");
  }else{
    atualizarFundoAnimado("sol");
  }
});
alertaObserver.observe(document.getElementById("alerta"),{attributes:true});
</script>
<!-- ===== FIM ===== -->

</body>
</html>